<!-- pages/owner/index.wxml -->
<navigation-bar title="货主端" back="{{false}}" color="white" background="#2c3e50"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <!-- 货主信息卡片 -->
    <view class="owner-card">
      <view class="owner-info">
        <image class="owner-avatar" src="{{userInfo.avatar}}" mode="aspectFill"></image>
        <view class="owner-details">
          <text class="owner-name">{{userInfo.name}}</text>
          <text class="owner-phone">{{userInfo.phone}}</text>
          <text class="owner-company">{{userInfo.company}}</text>
        </view>
      </view>
      <button class="create-btn" bindtap="createOrder">发布订单</button>
    </view>
    
    <!-- 统计信息 -->
    <view class="statistics-card">
      <view class="stat-item">
        <text class="stat-value">{{statistics.pendingOrders}}</text>
        <text class="stat-label">待接单</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{statistics.inProgressOrders}}</text>
        <text class="stat-label">运输中</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{statistics.completedOrders}}</text>
        <text class="stat-label">已完成</text>
      </view>
    </view>
    
    <!-- 订单列表 -->
    <view class="section-title">我的订单</view>
    <view class="order-list">
      <block wx:if="{{orderList.length > 0}}">
        <view class="order-item" wx:for="{{orderList}}" wx:key="id">
          <view class="order-header">
            <text class="order-id">订单号：{{item.id}}</text>
            <text class="order-status {{item.status === '待接单' ? 'status-waiting' : (item.status === '运输中' ? 'status-inprogress' : 'status-completed')}}">{{item.status}}</text>
          </view>
          
          <view class="order-content" bindtap="viewOrderDetail" data-id="{{item.id}}">
            <view class="order-route">
              <view class="location-item">
                <view class="location-dot start-dot"></view>
                <text class="location-text">{{item.startLocation}}</text>
              </view>
              <view class="route-line"></view>
              <view class="location-item">
                <view class="location-dot end-dot"></view>
                <text class="location-text">{{item.endLocation}}</text>
              </view>
            </view>
            
            <view class="order-info">
              <view class="info-item">
                <text class="info-label">货物类型：</text>
                <text class="info-value">{{item.goodsType}}</text>
              </view>
              <view class="info-item">
                <text class="info-label">重量：</text>
                <text class="info-value">{{item.weight}}</text>
              </view>
              <view class="info-item">
                <text class="info-label">创建时间：</text>
                <text class="info-value">{{item.createTime}}</text>
              </view>
              <view class="info-item">
                <text class="info-label">运费：</text>
                <text class="info-value price">{{item.price}}</text>
              </view>
              
              <!-- 司机信息（如果有） -->
              <block wx:if="{{item.driverInfo}}">
                <view class="driver-info-section">
                  <view class="info-item">
                    <text class="info-label">司机姓名：</text>
                    <text class="info-value">{{item.driverInfo.name}}</text>
                  </view>
                  <view class="info-item">
                    <text class="info-label">联系电话：</text>
                    <text class="info-value">{{item.driverInfo.phone}}</text>
                  </view>
                  <view class="info-item">
                    <text class="info-label">车牌号：</text>
                    <text class="info-value">{{item.driverInfo.carNumber}}</text>
                  </view>
                </view>
              </block>
              
              <!-- 完成时间（如果已完成） -->
              <block wx:if="{{item.status === '已完成'}}">
                <view class="info-item">
                  <text class="info-label">完成时间：</text>
                  <text class="info-value">{{item.completeTime}}</text>
                </view>
              </block>
            </view>
          </view>
          
          <view class="order-actions">
            <block wx:if="{{item.status === '待接单'}}">
              <button class="action-btn danger" bindtap="cancelOrder" data-id="{{item.id}}">取消订单</button>
            </block>
            <block wx:if="{{item.status === '运输中'}}">
              <button class="action-btn" bindtap="contactDriver" data-phone="{{item.driverInfo.phone}}">联系司机</button>
              <button class="action-btn primary" bindtap="confirmReceipt" data-id="{{item.id}}">确认收货</button>
            </block>
          </view>
        </view>
      </block>
      
      <view wx:if="{{orderList.length === 0}}" class="empty-list">
        <image class="empty-icon" src="/pages/images/empty.png" mode="aspectFit"></image>
        <text class="empty-text">暂无订单</text>
      </view>
    </view>
  </view>
</scroll-view>