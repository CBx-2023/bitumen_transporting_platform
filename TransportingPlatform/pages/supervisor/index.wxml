<!-- pages/supervisor/index.wxml -->
<navigation-bar title="监管端" back="{{false}}" color="white" background="#2c3e50"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <!-- 监管人员信息卡片 -->
    <view class="supervisor-card">
      <view class="supervisor-info">
        <image class="supervisor-avatar" src="{{userInfo.avatar}}" mode="aspectFill"></image>
        <view class="supervisor-details">
          <text class="supervisor-name">{{userInfo.name}}</text>
          <text class="supervisor-phone">{{userInfo.phone}}</text>
          <text class="supervisor-department">{{userInfo.department}}</text>
        </view>
      </view>
    </view>
    
    <!-- 统计信息 -->
    <view class="statistics-card">
      <view class="stat-item">
        <text class="stat-value">{{statistics.totalOrders}}</text>
        <text class="stat-label">总订单数</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{statistics.activeDrivers}}</text>
        <text class="stat-label">活跃司机</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{statistics.activeOwners}}</text>
        <text class="stat-label">活跃货主</text>
      </view>
    </view>
    
    <!-- 订单列表 -->
    <view class="section-title">订单监管</view>
    <view class="order-list">
      <block wx:if="{{orderList.length > 0}}">
        <view class="order-item" wx:for="{{orderList}}" wx:key="id">
          <view class="order-header">
            <text class="order-id">订单号：{{item.id}}</text>
            <text class="order-status {{item.status === '待接单' ? 'status-waiting' : (item.status === '运输中' ? 'status-inprogress' : 'status-completed')}}">{{item.status}}</text>
          </view>
          
          <view class="order-content" bindtap="viewOrderDetail" data-id="{{item.id}}">
            <view class="order-route">
              <view class="location-item">
                <view class="location-dot start-dot"></view>
                <text class="location-text">{{item.startLocation}}</text>
              </view>
              <view class="route-line"></view>
              <view class="location-item">
                <view class="location-dot end-dot"></view>
                <text class="location-text">{{item.endLocation}}</text>
              </view>
            </view>
            
            <view class="order-info">
              <view class="info-item">
                <text class="info-label">货物类型：</text>
                <text class="info-value">{{item.goodsType}}</text>
              </view>
              <view class="info-item">
                <text class="info-label">重量：</text>
                <text class="info-value">{{item.weight}}</text>
              </view>
              <view class="info-item">
                <text class="info-label">创建时间：</text>
                <text class="info-value">{{item.createTime}}</text>
              </view>
              
              <!-- 货主信息 -->
              <view class="participant-info">
                <view class="participant-header">货主信息</view>
                <view class="info-item">
                  <text class="info-label">姓名：</text>
                  <text class="info-value">{{item.ownerInfo.name}}</text>
                </view>
                <view class="info-item">
                  <text class="info-label">联系电话：</text>
                  <text class="info-value">{{item.ownerInfo.phone}}</text>
                </view>
                <view class="info-item">
                  <text class="info-label">公司：</text>
                  <text class="info-value">{{item.ownerInfo.company}}</text>
                </view>
              </view>
              
              <!-- 司机信息（如果有） -->
              <block wx:if="{{item.driverInfo}}">
                <view class="participant-info">
                  <view class="participant-header">司机信息</view>
                  <view class="info-item">
                    <text class="info-label">姓名：</text>
                    <text class="info-value">{{item.driverInfo.name}}</text>
                  </view>
                  <view class="info-item">
                    <text class="info-label">联系电话：</text>
                    <text class="info-value">{{item.driverInfo.phone}}</text>
                  </view>
                  <view class="info-item">
                    <text class="info-label">车牌号：</text>
                    <text class="info-value">{{item.driverInfo.carNumber}}</text>
                  </view>
                </view>
              </block>
            </view>
          </view>
          
          <view class="order-actions">
            <button class="action-btn" bindtap="contactOwner" data-phone="{{item.ownerInfo.phone}}">联系货主</button>
            <block wx:if="{{item.driverInfo}}">
              <button class="action-btn" bindtap="contactDriver" data-phone="{{item.driverInfo.phone}}">联系司机</button>
              <button class="action-btn primary" bindtap="viewTrack" data-id="{{item.id}}">查看轨迹</button>
            </block>
          </view>
        </view>
      </block>
      
      <view wx:if="{{orderList.length === 0}}" class="empty-list">
        <image class="empty-icon" src="/pages/images/empty.png" mode="aspectFit"></image>
        <text class="empty-text">暂无订单</text>
      </view>
    </view>
  </view>
</scroll-view>